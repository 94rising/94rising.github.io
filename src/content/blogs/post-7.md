---
title: "Sprint 2025-BY26-11 회고"
author: "이순범"
description: "단일 AI의 한계를 넘어 AI 에이전트 구조 설계 필요성을 느낀 2주간의 기록"
image:
  url: "../../assets/images/7.png"
  alt: "AI 에이전트 아키텍처 다이어그램"
pubDate: 2025-12-23
tags: ["AI Agent", "n8n", "Jira", "Architecture"]
---

12월 내내 AI 에이전트 시스템을 거의 새로 짰다. 단일 AI로 모든 티켓을 처리하던 구조가 한계를 보이더라. K8s 배포 요청에서 CPU 스펙은 무시하고 URL만 나열하거나, DB 생성 티켓에서 스토리지 크기를 제대로 못 읽는 식이다.

문제는 명확했다. 하나의 프롬프트로 서비스 배포부터 인프라 생성, 보안 요청까지 전부 커버하려니 각 영역의 전문성이 희석되는 거다. 게다가 Jira Webhook에서 오는 페이로드가 JSON String이 중첩된 구조였는데, 이걸 그대로 AI한테 던지니까 파싱 정확도가 떨어졌다.

## Router 패턴으로 갈아엎기

결국 "Router + 전문가 에이전트" 구조로 완전히 전환했다. 흐름은 이렇게 된다:

```
Data Prep → Router → 전문 프롬프트 → AI 처리 → Quality Gate
```

먼저 데이터 전처리 단계에서 리소스 스펙 같은 구조화된 필드는 기계적으로 파싱하고, description은 AI가 추론하도록 역할을 나눴다. 그다음 Router가 jobType을 보고 서비스 신청/리소스 생성/DevOps Tools 권한신청으로 분기시킨다.

각 경로마다 특화된 프롬프트를 적용하는 게 핵심이다. 서비스 신청이면 K8s CPU/Memory 적절성이랑 이미지 버전 검증에 집중하고, 리소스 생성이면 RDS 스토리지 크기나 엔진 선택, 백업 정책을 꼼꼼히 보게 했다. DevOps Tools 권한신청은 보안 정책 준수 여부를 체크하는 식으로.

마지막 Quality Gate가 재밌는데, AI 분석 결과에 8점 이상만 자동 승인하고 그 이하는 보완 요청을 보낸다. 처음엔 이게 필요한가 싶었는데, 막상 돌려보니 애매한 케이스를 한 번 더 걸러내는 효과가 확실하더라.

## Jira 필드 매핑 삽질기

Router 패턴 적용하면서 Jira 연계도 함께 손봤다. 대상 환경을 모든 티켓 타입에 통일적으로 전송하도록 개선했는데, 이게 문제를 만들었다. AWS 콘솔 계정 신청 타입에는 애초에 그 필드가 없어서 Jira API가 400 에러를 뱉는 거다.

원인을 찾고 나니 간단했다. Jira는 이슈 타입마다 필드 스키마가 다른데, 나는 그걸 간과하고 있었던 거지. job.js 113번 라인에서 AWS 콘솔 계정 신청(타입 C)만 customfield_16600 전송 대상에서 제외시켜서 해결했다.


이것 말고도 리소스 스펙을 확장해서 Description을 간소화하고, DEV 환경에서도 Jira API 호출 가능하게 개선했다. 지금은 PRD 배포 대기 중이다.

## 배운 것들

단일 범용 AI보다 도메인별로 전문화된 프롬프트가 압도적으로 정확하다는 걸 확인했다. 데이터 전처리와 AI 추론의 역할을 명확히 분리하는 게 성능 향상의 핵심이었고, Quality Gate를 통한 점진적 개선이 프로덕션 안정성 확보에 효과적이었다.

Jira 쪽에서는 필드 스키마가 이슈 타입마다 다를 수 있다는 걸 뼈저리게 배웠다. 통합 작업할 때는 모든 타입에 대한 엣지 케이스 테스트가 필수라는 것도. 타입별 필드 매핑 문서를 제대로 만들어뒀으니 다음엔 이런 삽질을 반복하지 않을 것 같다.

2025년 계획도 몇 가지 잡았다. Assistant Agent를 Webhook 기반 트리거로 전환해서 실시간성을 높이고, AI Agent 아키텍처로 만들 예정이다. 티켓 분석 시스템이 월 500-600건 이상 규모로 커질 거라 확장 대응도 준비해야 하고, ASAP 플랫폼이랑 Jira 간 메타데이터 자동 전송 체계도 구축할 계획이다.

